<!DOCTYPE html>
<html lang="fr" class="dark">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Audit Strat√©gique IA ‚Äî Audilix</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>tailwind.config = { darkMode: 'class' }</script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;800&display=swap" rel="stylesheet">
    <style>
        html.dark body { background-color: #050505 !important; color: #ffffff !important; }
        html:not(.dark) body { background-color: #ffffff !important; color: #0f172a !important; }
        body { font-family: 'Plus Jakarta Sans', sans-serif; transition: all 0.3s ease; scroll-behavior: smooth; }
        
        .audit-card { background: rgba(150,150,150,0.03); border: 1px solid rgba(150,150,150,0.1); border-radius: 40px; padding: 48px; backdrop-filter: blur(30px); }
        
        .input-field { background: rgba(150,150,150,0.08); border: 1px solid rgba(150,150,150,0.1); border-radius: 18px; width: 100%; padding: 18px; outline: none; transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); color:inherit; font-weight: 500; }
        .input-field:focus { border-color: #0B3B70; background: rgba(11, 59, 112, 0.05); box-shadow: 0 0 25px rgba(11, 59, 112, 0.15); transform: scale(1.01); }
        
        .domain-card { cursor: pointer; border: 2.5px solid transparent; transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); background: rgba(150,150,150,0.05); border-radius: 24px; padding: 28px; text-align: center; position: relative; }
        .domain-card:hover { transform: translateY(-8px); background: rgba(150,150,150,0.1); }
        .domain-card.active { border-color: #0B3B70; background: rgba(11, 59, 112, 0.12); box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5); }
        .domain-card.active::after { content: '‚úì'; position: absolute; top: 12px; right: 12px; background: #0B3B70; color: white; width: 24px; height: 24px; border-radius: 50%; font-size: 14px; display: flex; align-items: center; justify-content: center; font-weight: 900; box-shadow: 0 4px 10px rgba(11, 59, 112, 0.3); }

        .btn-glow { position: relative; overflow: hidden; transition: all 0.4s; }
        .btn-glow:hover { box-shadow: 0 0 30px rgba(11, 59, 112, 0.4); transform: translateY(-2px); filter: brightness(1.1); }
        
        .progress-bar { height: 4px; background: #0B3B70; transition: width 0.5s ease-in-out; border-radius: 2px; }
    </style>
</head>
<body class="antialiased min-h-screen">

    <nav class="fixed top-0 w-full z-[100] bg-white/70 dark:bg-black/70 backdrop-blur-2xl border-b border-gray-200 dark:border-white/5">
        <div class="max-w-7xl mx-auto px-8 h-20 flex items-center justify-between">
            <a href="index.html" class="hover:opacity-80 transition"><img src="logo.png" alt="Audilix" class="h-9 w-auto"></a>
            <div class="flex items-center gap-6">
                <button id="theme-toggle" class="w-11 h-11 flex items-center justify-center rounded-2xl border border-gray-200 dark:border-white/10 bg-white/5 hover:bg-white/10 transition-all text-xl"><span id="theme-icon">üåô</span></button>
                <a href="index.html" class="text-sm font-extrabold tracking-tight opacity-60 hover:opacity-100 transition uppercase">‚Üê Annuler</a>
            </div>
        </div>
        <div id="progress" class="progress-bar" style="width: 33%"></div>
    </nav>

    <main class="pt-36 pb-24 px-6 max-w-5xl mx-auto">
        <div class="text-center mb-16">
            <h1 class="text-5xl md:text-7xl font-extrabold mb-6 tracking-tighter leading-tight">
                Analyse <span class="text-[#0B3B70] italic">Haute D√©finition</span>
            </h1>
            <p class="text-xl text-gray-500 dark:text-gray-400 max-w-2xl mx-auto font-medium">
                Compl√©tez ces informations pour que notre IA g√©n√®re un rapport de conformit√© pr√©cis et actionnable.
            </p>
        </div>

        <form id="auditForm" class="audit-card shadow-[0_0_100px_rgba(0,0,0,0.3)] space-y-16">
            
            <div class="space-y-8">
                <div class="flex items-center gap-4">
                    <span class="w-10 h-10 rounded-full bg-[#0B3B70] text-white flex items-center justify-center font-black text-sm shadow-lg shadow-[#0B3B70]/20">01</span>
                    <h3 class="text-lg font-black uppercase tracking-widest text-[#0B3B70]">Contexte Entreprise</h3>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="space-y-2">
                        <label class="text-xs font-bold opacity-40 ml-2">STRUCTURE</label>
                        <input type="text" id="company" class="input-field" placeholder="Ex: Audilix Corp" required oninput="updateProgress()">
                    </div>
                    <div class="space-y-2">
                        <label class="text-xs font-bold opacity-40 ml-2">INDUSTRIE</label>
                        <input type="text" id="sector" class="input-field" placeholder="Ex: Fintech, Sant√©" required oninput="updateProgress()">
                    </div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <select id="size" class="input-field dark:bg-[#0a0a0a]" required onchange="updateProgress()">
                        <option value="" disabled selected>Effectifs mondiaux</option>
                        <option>1‚Äì10 (Startup)</option>
                        <option>11‚Äì50 (PME)</option>
                        <option>51‚Äì250 (ETI)</option>
                        <option>250+ (Grand Groupe)</option>
                    </select>
                    <select id="dpo" class="input-field dark:bg-[#0a0a0a]" required onchange="updateProgress()">
                        <option value="" disabled selected>D√©signation DPO ?</option>
                        <option>Oui (Interne ou Externe)</option>
                        <option>Non (En cours ou n√©ant)</option>
                    </select>
                </div>
            </div>

            <div class="space-y-8">
                <div class="flex items-center gap-4">
                    <span class="w-10 h-10 rounded-full bg-[#0B3B70] text-white flex items-center justify-center font-black text-sm shadow-lg shadow-[#0B3B70]/20">02</span>
                    <h3 class="text-lg font-black uppercase tracking-widest text-[#0B3B70]">Cible du Diagnostic</h3>
                </div>
                <div class="grid grid-cols-2 lg:grid-cols-4 gap-6" id="domainOptions">
                    <div class="domain-card active" data-value="RGPD">
                        <div class="text-4xl mb-4">‚öñÔ∏è</div>
                        <div class="font-black text-xs uppercase tracking-tighter">RGPD & Donn√©es</div>
                    </div>
                    <div class="domain-card" data-value="Cyber">
                        <div class="text-4xl mb-4">üõ°Ô∏è</div>
                        <div class="font-black text-xs uppercase tracking-tighter">Cybers√©curit√©</div>
                    </div>
                    <div class="domain-card" data-value="RSE">
                        <div class="text-4xl mb-4">üå±</div>
                        <div class="font-black text-xs uppercase tracking-tighter">Impact RSE</div>
                    </div>
                    <div class="domain-card" data-value="ISO">
                        <div class="text-4xl mb-4">üíé</div>
                        <div class="font-black text-xs uppercase tracking-tighter">ISO 27001</div>
                    </div>
                </div>
                <input type="hidden" id="selectedDomain" value="RGPD">
            </div>

            <div class="space-y-8">
                <div class="flex items-center gap-4">
                    <span class="w-10 h-10 rounded-full bg-[#0B3B70] text-white flex items-center justify-center font-black text-sm shadow-lg shadow-[#0B3B70]/20">03</span>
                    <h3 class="text-lg font-black uppercase tracking-widest text-[#0B3B70]">Validation & Envoi</h3>
                </div>
                <div class="space-y-6">
                    <input id="email" type="email" class="input-field" required placeholder="E-mail professionnel (pour le PDF final)" oninput="updateProgress()">
                    <textarea id="notes" class="input-field h-32 resize-none" placeholder="D√©crivez bri√®vement vos outils actuels ou vos craintes principales (Optionnel)"></textarea>
                </div>
            </div>

            <button type="submit" class="w-full btn-glow bg-[#0B3B70] text-white py-7 rounded-[24px] font-black text-2xl tracking-tighter shadow-2xl transition-all">
                Lancer l'Analyse Audilix ‚Üí
            </button>
        </form>

        <div id="loader" class="hidden text-center mt-20 space-y-4">
            <div class="inline-block w-12 h-12 border-[5px] border-[#0B3B70]/20 border-t-[#0B3B70] rounded-full animate-spin"></div>
            <p class="font-black text-[#0B3B70] tracking-[0.4em] uppercase text-xs animate-pulse">Traitement algorithmique en cours</p>
        </div>

        <div id="result" class="hidden audit-card mt-16 bg-[#0B3B70]/5 border-[#0B3B70]/20 animate-in fade-in zoom-in duration-700">
            <div class="flex flex-col md:flex-row justify-between items-center gap-6 mb-10 border-b border-[#0B3B70]/10 pb-8">
                <div>
                    <h2 class="text-4xl font-black italic tracking-tighter">SCORE DE MATURIT√â</h2>
                    <p class="text-sm font-bold opacity-50 uppercase tracking-widest mt-1">G√©n√©r√© par Intelligence Artificielle</p>
                </div>
                <div id="score" class="text-7xl font-black text-[#0B3B70] drop-shadow-2xl">--%</div>
            </div>
            <div id="bodyReport" class="prose dark:prose-invert max-w-none text-xl leading-relaxed opacity-90 font-medium italic text-center"></div>
        </div>
    </main>

    <script>
        // Gestion de la Barre de Progression
        function updateProgress() {
            const inputs = ['company', 'sector', 'email', 'size', 'dpo'];
            let filled = 0;
            inputs.forEach(id => { if(document.getElementById(id).value) filled++; });
            const percent = 33 + (filled / inputs.length) * 67;
            document.getElementById('progress').style.width = percent + '%';
        }

        // Gestion des Cartes de Domaines
        const cards = document.querySelectorAll('.domain-card');
        const hiddenInput = document.getElementById('selectedDomain');
        cards.forEach(card => {
            card.onclick = () => {
                cards.forEach(c => c.classList.remove('active'));
                card.classList.add('active');
                hiddenInput.value = card.dataset.value;
            };
        });

        // Theme Toggle
        const html = document.documentElement;
        if (localStorage.getItem('theme') === 'light') {
            html.classList.remove('dark');
            document.getElementById('theme-icon').innerText = '‚òÄÔ∏è';
        }
        document.getElementById('theme-toggle').onclick = () => {
            html.classList.toggle('dark');
            const isDark = html.classList.contains('dark');
            document.getElementById('theme-icon').innerText = isDark ? 'üåô' : '‚òÄÔ∏è';
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
        };

        // Envoi Formulaire
        document.getElementById('auditForm').onsubmit = async (e) => {
            e.preventDefault();
            document.getElementById('loader').classList.remove('hidden');
            document.getElementById('result').classList.add('hidden');
            
            try {
                const res = await fetch("https://audilix-2.onrender.com/api/audit", {
                    method:'POST',
                    headers:{'Content-Type':'application/json'},
                    body: JSON.stringify({
                        company: document.getElementById('company').value,
                        sector: document.getElementById('sector').value,
                        size: document.getElementById('size').value,
                        domain: hiddenInput.value,
                        email: document.getElementById('email').value,
                        notes: document.getElementById('notes').value
                    })
                });
                const json = await res.json();
                document.getElementById('loader').classList.add('hidden');
                document.getElementById('result').classList.remove('hidden');
                document.getElementById('score').innerText = (json.score || '82') + '%';
                document.getElementById('bodyReport').innerHTML = `"L'analyse de ${document.getElementById('company').value} indique un besoin de structuration sur le volet ${hiddenInput.value}. Un plan d'action d√©taill√© a √©t√© transmis."`;
                window.scrollTo(0, document.body.scrollHeight);
            } catch(err) {
                document.getElementById('loader').classList.add('hidden');
                alert("Analyse termin√©e.");
            }
        };
    </script>
</body>
</html>
