<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Audit IA — Audilix</title>
<style>
body { font-family: Arial, sans-serif; background:#f7f9fc; margin:0; padding:0; }
.container { max-width: 720px; margin: auto; padding: 32px; }
h1 { text-align:center; margin-bottom:18px; }
label { font-weight: bold; margin-top:18px; display:block; }
input, textarea, select {
  width:100%; padding:12px; margin-top:6px; border-radius:6px;
  border:1px solid #dcdfe6; font-size:16px;
}
button {
  width:100%; background:#0049ff; border:none; color:white;
  padding:16px; border-radius:8px; font-size:18px;
  margin-top:20px; cursor:pointer; transition:0.2s;
}
button:hover { background:#0034bd; }
#loader { display:none; text-align:center; margin-top:26px; font-size:18px; }
#auditResult { display:none; background:white; padding:26px;
  border-radius:12px; margin-top:28px; border:1px solid #e0e6ef; }
.score { font-size:34px; font-weight:900; text-align:center; margin-bottom:14px; }
.risks, .reco { margin-top:16px; }
ul { margin:0; padding-left:22px; }
</style>
</head>

<body>
<div class="container">
<h1>Audit de conformité IA</h1>
<p>Répondez aux questions ci-dessous. Le rapport sera généré automatiquement par l’intelligence artificielle.</p>

<form id="auditForm">
  <label>Nom de l’entreprise</label>
  <input type="text" id="company" required />

  <label>Secteur d’activité</label>
  <input type="text" id="sector" required />

  <label>Taille de l’entreprise</label>
  <select id="size">
    <option>1–10 employés</option>
    <option>11–50 employés</option>
    <option>51–250 employés</option>
    <option>250+ employés</option>
  </select>

  <label>Domaines à analyser</label>
  <select id="domains" multiple>
    <option>RGPD</option>
    <option>Cybersécurité</option>
    <option>ISO 27001</option>
    <option>RSE</option>
    <option>Gestion des données</option>
  </select>

  <label>L’entreprise dispose-t-elle d’un DPO ?</label>
  <select id="dpo">
    <option>Oui</option>
    <option>Non</option>
  </select>

  <label>Commentaires supplémentaires</label>
  <textarea id="notes" rows="4" placeholder="Informations utiles (facultatif)"></textarea>

  <button type="submit">Générer mon audit</button>
</form>

<div id="loader">⏳ Analyse IA en cours…</div>

<div id="auditResult"></div>

</div>

<script>
document.getElementById("auditForm").addEventListener("submit", async (e) => {
  e.preventDefault();

  const data = {
    company: document.getElementById("company").value,
    sector: document.getElementById("sector").value,
    size: document.getElementById("size").value,
    domains: Array.from(document.getElementById("domains").selectedOptions).map(o => o.value),
    has_dpo: document.getElementById("dpo").value,
    notes: document.getElementById("notes").value,
  };

  document.getElementById("loader").style.display = "block";
  document.getElementById("auditResult").style.display = "none";

  try {
    const res = await fetch("https://audilix-2.onrender.com/api/audit", {
      method:"POST",
      headers:{ "Content-Type":"application/json" },
      body: JSON.stringify(data)
    });

    const out = await res.json();
    document.getElementById("loader").style.display = "none";
    document.getElementById("auditResult").style.display = "block";

    document.getElementById("auditResult").innerHTML = `
      <div class="score">${out.score}/100</div>
      <div class="summary">${out.summary}</div>
      <div class="risks"><h3>Risques identifiés</h3><ul>${out.risks.map(r => `<li>${r}</li>`).join("")}</ul></div>
      <div class="reco"><h3>Recommandations</h3><ul>${out.recommendations.map(r => `<li>${r}</li>`).join("")}</ul></div>
    `;
  } catch (err) {
    document.getElementById("loader").style.display = "none";
    alert("Erreur IA — réessayez dans 1 minute");
  }
});
</script>

</body>
</html>
